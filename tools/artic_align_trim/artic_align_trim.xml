<tool id="artic_align_trim" name="ARTIC align_trim" version="0.1.0+galaxy0">
    <description>Trim aligned reads based on a set of primer loci</description>
    <requirements>
        <requirement type="package" version="0.15.3">pysam</requirement>
        <requirement type="package" version="1.9">samtools</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        '${__tool_directory__}/align_trim.py'
             '${bedfile}'
             --start 
             --report '${start_trim_report}'
             < '${input_alignment}'
             2> '${start_trim_err}' |
        samtools view -bS - |
        samtools sort - -o '${trimmed_sorted_alignment}' 
    ]]></command>
    <inputs>
        <input name="input_alignment" format="bam"/>
        <param name="bedfile" type="select" format="bed">
	    <options from_data_table="primer_scheme_bedfiles">
	        <validator type="no_options" message="No primer scheme .bed files are available" />
            </options>
	</param>
    </inputs>
    <outputs>
        <data name="start_trim_report" format="txt" label="Alignment Report" />
        <data name="start_trim_err" format="txt" label="Alignment Error Report" />
        <data name="trimmed_sorted_alignment" format="bam" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help><![CDATA[
    ]]></help>
    <citations>
    </citations>
</tool>
